<!DOCTYPE html>
<!-- <copyright>
 This file contains proprietary software owned by Motorola Mobility, Inc.<br/>
 No rights, expressed or implied, whatsoever to this software are provided by Motorola Mobility, Inc. hereunder.<br/>
 (c) Copyright 2011 Motorola Mobility, Inc.  All Rights Reserved.
 </copyright> -->
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
    <script src="../../../../montage.js"></script>
    <script type="text/montage-serialization">
        {
            "image1": {
                "module": "image3d.reel",
                "name": "Image3D",
                "properties": {
                    "element": {"#": "image"}
                },
                "bindings": {
                    "data": {
                        "boundObject": {"@": "flow1"},
                        "boundObjectPropertyPath": "objectAtCurrentIteration",
                        "oneway": true
                    }
                }
            },
            "scroll1": {
                "module": "montage/ui/scroll",
                "name": "Scroll",
                "properties": {
                    "component": {"@": "flow1"}
                },
                "bindings": {
                    "element": {
                        "boundObject": {"@": "flow1"},
                        "boundObjectPropertyPath": "_element",
                        "oneway": true
                    },
                    "maxScrollX": {
                        "boundObject": {"@": "flow1"},
                        "boundObjectPropertyPath": "length",
                        "oneway": true
                    },
                    "scrollX": {
                        "boundObject": {"@": "flow1"},
                        "boundObjectPropertyPath": "origin"
                    }
                }
            },
            "nearest": {
                "module": "montage/ui/nearest-neighbor-component-search",
                "name": "NearestNeighborComponentSearch",
                "bindings": {
                    "componentList": {
                        "boundObject": {"@": "flow1"},
                        "boundObjectPropertyPath": "_repetitionComponents",
                        "oneway": true
                    },
                    "pointerPosition": {
                        "boundObject": {"@": "scroll1"},
                        "boundObjectPropertyPath": "pointerStartEventPosition",
                        "oneway": true                    
                    }
                }
            },
            "flow1": {
                "module": "montage/ui/flow.reel",
                "name": "Flow",
                "properties": {
                    "element": {"#": "flow"},
                    "objects": [
                        {"src": "images/0.jpg", "text": "Flames"},
                        {"src": "images/1.jpg", "text": "Sail"},
                        {"src": "images/2.jpg", "text": "Snow"},
                        {"src": "images/3.jpg", "text": "Mountains"},
                        {"src": "images/4.jpg", "text": "Rocky"},
                        {"src": "images/5.jpg", "text": "Road"},
                        {"src": "images/6.jpg", "text": "Lorem Ipsum 0"},
                        {"src": "images/7.jpg", "text": "Lorem Ipsum 1"},
                        {"src": "images/8.jpg", "text": "Lorem Ipsum 2"},
                        {"src": "images/9.jpg", "text": "Lorem Ipsum 3"},
                        {"src": "images/10.jpg", "text": "Lorem Ipsum 4"},
                        {"src": "images/11.jpg", "text": "Lorem Ipsum 5"},
                        {"src": "images/12.jpg", "text": "Lorem Ipsum 6"},
                        {"src": "images/13.jpg", "text": "Lorem Ipsum 7"},
                        {"src": "images/14.jpg", "text": "Lorem Ipsum 8"}
                    ],
                    "cameraRotationAxisX": 1,
                    "cameraRotationAxisY": 0,
                    "cameraRotationAxisZ": 0                    
                },
                "bindings": {
                    "path": {
                        "boundObject": {"@": "pathLerp1"},
                        "boundObjectPropertyPath": "resultPath",
                        "oneway": true
                    },
                    "cameraRotationAngle": {
                        "boundObject": {"@": "slider3"},
                        "boundObjectPropertyPath": "value",
                        "oneway": true
                    },
                    "selectedSlideIndex": {
                        "boundObject": {"@": "nearest"},
                        "boundObjectPropertyPath": "nearestNeighborComponent",
                        "oneway": true  
                    },
                    "scale": {
                        "boundObject": {"@": "slider2"},
                        "boundObjectPropertyPath": "value",
                        "oneway": true  
                    }
                }
            },
            "path1": {
                "module": "montage/ui/flow-path",
                "name": "FlowPath",
                "properties": {
                    "evalPath": [                        
                        "path.translateX = slide.time-slide.index*155+50",
                        "path.translateY = (slide.index%3)*240-150",
                        "path.translateZ = -slide.time/3",
                        "path.rotateX = slide.speed/200",
                        "path.rotateY = 1",
                        "path.rotateZ = slide.time/500",
                        "path.style.opacity = 1.2 - slide.time/4000"
                    ]
                }
            },
            "path2": {
                "module": "montage/ui/flow-path",
                "name": "FlowPath",
                "properties": {
                    "evalPath": [
                        "path.translateX = slide.time",
                        "path.translateY = 0",
                        "path.translateZ = slide.time*slide.time/-1500",
                        "path.rotateX = 0",
                        "path.rotateY = slide.time/1200",
                        "path.rotateZ = slide.speed/1500",
                        "path.style.opacity = 1"
                    ]
                }
            },
            "pathLerp1": {
                "module": "montage/ui/flow-path-lerp",
                "name": "FlowPathLerp",
                "bindings": {
                    "path1": {
                        "boundObject": {"@": "path1"},
                        "boundObjectPropertyPath": "path",
                        "oneway": true
                    },
                    "path2": {
                        "boundObject": {"@": "path2"},
                        "boundObjectPropertyPath": "path",
                        "oneway": true
                    },
                    "interpolant": {
                        "boundObject": {"@": "slider1"},
                        "boundObjectPropertyPath": "value"
                    }
                }
            },
            "pathCode1": {
                "module": "montage/ui/bluemoon/textarea.reel",
                "name": "TextArea",
                "properties": {
                    "element": {"#": "pathCode1"}
                },
                "bindings": {
                    "value": {
                        "boundObject": {"@": "path1"},
                        "boundObjectPropertyPath": "evalPath"
                    }
                }
            },
            "pathCode2": {
                "module": "montage/ui/bluemoon/textarea.reel",
                "name": "TextArea",
                "properties": {
                    "element": {"#": "pathCode2"}
                },
                "bindings": {
                    "value": {
                        "boundObject": {"@": "path2"},
                        "boundObjectPropertyPath": "evalPath"
                    }
                }
            },
            "slider1": {
                "module": "montage/ui/bluemoon/slider.reel",
                "name": "Slider",
                "properties": {
                    "element": {"#": "slider"},
                    "minValue": 0,
                    "maxValue": 1
                }
            },
            "slider2": {
                "module": "montage/ui/bluemoon/slider.reel",
                "name": "Slider",
                "properties": {
                    "element": {"#": "slider2"},
                    "minValue": 320,
                    "maxValue": 600
                }
            },
            "slider3": {
                "module": "montage/ui/bluemoon/slider.reel",
                "name": "Slider",
                "properties": {
                    "element": {"#": "slider3"},
                    "minValue": -0.5,
                    "maxValue": 0.5,
                    "value": 0
                }
            },
            "owner": {
                "module": "flow-test",
                "name": "FlowTest"
            }
        }
    </script>
    <style>
        .flow {
            position: absolute;
            top: 0;
            left: 0;
            right: 380px;
            bottom: 0;
            -webkit-perspective: 800px;
            background: -webkit-gradient(linear, left top, left bottom, from(#666), to(#bbb));            
        }
        #rightPannel {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 360px;
            padding: 10px;
        }
        .pathCode {
            width: 340px;
            height: 135px;
        }
        .image {
            position: absolute;
            top: 50%;
            left: 50%;
            -webkit-box-shadow: 0 0 35px rgba(0,0,0,.5);
        }
    </style>
</head>
<body>
    <div id="flow" class="flow">
        <div id="image" class="image"></div>
    </div>
    <div id="rightPannel">
        Path 1:
        <textarea id="pathCode1" class="pathCode"></textarea>
        Path 2:
        <textarea id="pathCode2" class="pathCode"></textarea>
        Path linear interpolation:
        <div id="slider"></div>
        Slide spacing
        <div id="slider2"></div>
        Camera rotation angle
        <div id="slider3"></div>
    </div>
</body>
</html>